<!DOCTYPE html>
<meta name="robots" content="noindex">
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

  <script type="text/javascript" src="script.js"></script>
  <script type="text/javascript" src="toDoScript.js"></script>
  <link type="text/css" rel="stylesheet" href="style.css"></link>
  <script type="text/javascript" src="primus.js"></script>

  <script>
      var connection = Primus.connect("http://127.0.0.1:9000", {
        reconnect: 
        {
          max: 2000, // Number: The max delay before we try to reconnect.
          min: 500, // Number: The minimum delay before we try reconnect.
          retries: Infinity // Number: How many times we should try to reconnect.
        }
      });

      /** Connect to Signal Relay **/
      // Cortex should act as a client and connect to Signal
      // Using primus.js and websockets as the transport.
      var send_protolobe_interval;
      connection.on('open', () =>
      {
        clearInterval(send_protolobe_interval);
        console.log('Connected to RoverCore!');
        send_protolobe_interval = setInterval(function() {
          connection.write({
            target: 'Protolobe',
            command: 'test_data'
          });
        }, 2500);
        connection.write(
        {
          target: 'Cortex',
          command: 'Protolobe',
        });
        console.log("CONNECTED! I AM HERE!");
      });
      connection.on('data', (data) =>
      {
        console.log('PRINTED FROM SERVER:', data);
      });
      connection.on('error',  (err) =>
      {
        console.log('CONNECTION error!', err.stack);
      });
      connection.on('reconnect', () =>
      {
        console.log('RECONNECTION attempt started!');
      });
      connection.on('reconnect scheduled', (opts) =>
      {
        console.log(`Reconnecting in ${opts.scheduled} ms`);
        console.log(`This is attempt ${opts.attempt} out of ${opts.retries}`);
      });
      connection.on('reconnected', (opts) =>
      {
        console.log(`It took ${opts.duration} ms to reconnect`);
      });
      connection.on('reconnect timeout', (err) =>
      {
        console.log(`Timeout expired: ${err.message}`);
      });
      connection.on('reconnect failed', (err) =>
      {
        console.log(`The reconnection failed: ${err.message}`);
      });
      connection.on('end', () =>
      {
        console.log('Disconnected from RoverCore');
        clearInterval(send_protolobe_interval);
      });
    </script>

  <title>xhr.responseType='document' Test</title>
</head>

<body>


<!--BEGIN HEADING-->
    <div class= "container-fluid">
        <div class="row" id="header">
              <div class="col-xs-11">
                <div class="col-xs-2" id="header-item">
                    <ul>
                        <li><h4 class="drive">Drive</h4></li>
                    </ul>
                </div>
                <div class="col-xs-2" id="header-item">
                    <ul>
                        <li><h4 class="arm">Arm</h4></li>
                    </ul>            
                </div>
                <div class="col-xs-2" id="header-item">
                    <ul>
                        <li><h4>Tracker</h4></li>
                    </ul>
                </div>
                <div class="col-xs-2" id="header-item">
                    <ul>
                        <li><h4>Science</h4></li>
                    </ul>
                </div>
                <div class="col-xs-2" id="header-item">
                    <ul>
                        <li><h4>GPS</h4></li>
                    </ul>
               </div>
                <div class="col-xs-2" id="header-item">
                    <ul>
                        <li><h4>Telemetry</h4></li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-1">
              <div class="dropdown" id="header-item">
                <button onclick="myFunction()" class="dropbtn">Servers</button>
                <div id="myDropdown" class="dropdown-content">
                  <a href="#">Server 1</a>
                  <a href="#">LocalHost</a>
                </div>
              </div>

            </div>
        </div> 
      </div>
<!--END OF HEADING --> 

<!--BEGIN SIDEBAR/FEEDBACK-->
    <div class="row" id="lower-half">
        <div class="col-xs-3"  id="sidebar"> 
          <div id="feedback">
           <div>Feedback from the rover will show here</div>
           
          </div>

      <button class="row" id="mute">
        MUTE!
      </button>

      </div>
<!--END SIDEBAR/FEEDBACK-->


<!--BEGIN MODULE SECTION-->

        <div class="col-xs-9" id="module">
            <ol><em>Loading...</em></ol>
        </div>
    </div>
<!--END MODULE SECTION-->

<!--[if IE]>
<script src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
<script>CFInstall.check({mode: 'overlay'});</script>
<![endif]-->
</body>
</html>